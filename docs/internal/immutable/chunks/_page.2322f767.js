import{S as fe,i as he,s as be,h as ye,e as ce,a as pe,u as ke,t as D,b as E,d as j,c as ue,o as $e,f as L,n as y,g as Q,j as T,k as R,l as W,m as Z,p as A,q as x,r as ee,v as $,w as O,x as B}from"./index.5b30edc6.js";import{B as we}from"./index.abd82d87.js";import{M as ve,f as qe,C as Ce,L as De,D as _e,A as Ee,a as Me,b as Se,S as ge,B as Le,c as Te}from"./http_client.d27732d5.js";import{d as Ae}from"./database.162aa2b0.js";import{m as K}from"./model_out.f4085c8e.js";import{p as Oe}from"./params.40a0f8ce.js";function Be(t){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function Pe(t){let c,l,a,s,o,V,e,G,b,w,N,u,v,g,M,m,P,p,_,F,f,U,q,H,ne={id:"l1",magic:t[10],exportFunc:"saveToConvex",importFunc:"getFromConvex",dataTable:"Ethiopia_Data",stateTable:"Ethiopia_State",client:t[12]};a=new De({props:ne}),t[13](a);let te={id:"Village_Dropdown",index:0,dropdown_key:"village"};o=new _e({props:te}),t[14](o);let ae={id:"Alert",threshold_string:"1.0",key:"combined_payout"};e=new Ee({props:ae}),t[15](e);let re={id:"lc1",name:"line",title:"Climatology",magic:t[10],xAttr:"dekad",yAttr:"average_value",xDomainMin:"1",xDomainMax:"36"};w=new Me({props:re}),t[16](w);let le={name:"testCropCal",id:"cc1",magic:t[10],xDomainMin:"1",xDomainMax:"36"};u=new Se({props:le}),t[17](u);let se={min:"1",max:"36",id:"PlantEarly",description:"fusion  sum early"};g=new ge({props:se}),t[18](g);let ie={min:"1",max:"36",id:"PlantLate",description:"fusion  sum late"};m=new ge({props:ie}),t[19](m);let n={id:"bgc1",name:"Bar Grouped",title:"Payouts",magic:t[10],groupNames:["sum_early","sum_late","combined_payout"],xAttr:"year",yAttr:"value",yMax:"1",xDomainMin:"2000",xDomainMax:"2020"};_=new Le({props:n}),t[20](_);let z={id:"d2",index:0,dropdown_key:"value"};f=new _e({props:z}),t[21](f);let J={name:"Matching Table",id:"m1"};return q=new Te({props:J}),t[22](q),{c(){c=Q("div"),l=Q("div"),T(a.$$.fragment),s=R(),T(o.$$.fragment),V=R(),T(e.$$.fragment),G=R(),b=Q("div"),T(w.$$.fragment),N=R(),T(u.$$.fragment),v=R(),T(g.$$.fragment),M=R(),T(m.$$.fragment),P=R(),p=Q("div"),T(_.$$.fragment),F=R(),T(f.$$.fragment),U=R(),T(q.$$.fragment),this.h()},l(r){c=W(r,"DIV",{class:!0});var k=Z(c);l=W(k,"DIV",{class:!0});var S=Z(l);A(a.$$.fragment,S),s=x(S),A(o.$$.fragment,S),V=x(S),A(e.$$.fragment,S),S.forEach(j),G=x(k),b=W(k,"DIV",{class:!0});var h=Z(b);A(w.$$.fragment,h),N=x(h),A(u.$$.fragment,h),v=x(h),A(g.$$.fragment,h),M=x(h),A(m.$$.fragment,h),h.forEach(j),P=x(k),p=W(k,"DIV",{class:!0});var C=Z(p);A(_.$$.fragment,C),F=x(C),A(f.$$.fragment,C),U=x(C),A(q.$$.fragment,C),C.forEach(j),k.forEach(j),this.h()},h(){ee(l,"class","grid items-center py-2 col-span-1 md:col-span-2 lg:col-span-2"),ee(b,"class","grid col-span-1"),ee(p,"class","col-span-1"),ee(c,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2")},m(r,k){pe(r,c,k),$(c,l),O(a,l,null),$(l,s),O(o,l,null),$(l,V),O(e,l,null),$(c,G),$(c,b),O(w,b,null),$(b,N),O(u,b,null),$(b,v),O(g,b,null),$(b,M),O(m,b,null),$(c,P),$(c,p),O(_,p,null),$(p,F),O(f,p,null),$(p,U),O(q,p,null),H=!0},p(r,k){const S={};a.$set(S);const h={};o.$set(h);const C={};e.$set(C);const X={};w.$set(X);const I={};u.$set(I);const d={};g.$set(d);const i={};m.$set(i);const Y={};_.$set(Y);const de={};f.$set(de);const oe={};q.$set(oe)},i(r){H||(D(a.$$.fragment,r),D(o.$$.fragment,r),D(e.$$.fragment,r),D(w.$$.fragment,r),D(u.$$.fragment,r),D(g.$$.fragment,r),D(m.$$.fragment,r),D(_.$$.fragment,r),D(f.$$.fragment,r),D(q.$$.fragment,r),H=!0)},o(r){E(a.$$.fragment,r),E(o.$$.fragment,r),E(e.$$.fragment,r),E(w.$$.fragment,r),E(u.$$.fragment,r),E(g.$$.fragment,r),E(m.$$.fragment,r),E(_.$$.fragment,r),E(f.$$.fragment,r),E(q.$$.fragment,r),H=!1},d(r){r&&j(c),t[13](null),B(a),t[14](null),B(o),t[15](null),B(e),t[16](null),B(w),t[17](null),B(u),t[18](null),B(g),t[19](null),B(m),t[20](null),B(_),t[21](null),B(f),t[22](null),B(q)}}}function Re(t){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function xe(t){let c,l,a={ctx:t,current:null,token:null,hasCatch:!1,pending:Re,then:Pe,catch:Be,value:33,blocks:[,,,]};return ye(t[11],a),{c(){c=ce(),a.block.c()},l(s){c=ce(),a.block.l(s)},m(s,o){pe(s,c,o),a.block.m(s,a.anchor=o),a.mount=()=>c.parentNode,a.anchor=c,l=!0},p(s,o){t=s,ke(a,t,o)},i(s){l||(D(a.block),l=!0)},o(s){for(let o=0;o<3;o+=1){const V=a.blocks[o];E(V)}l=!1},d(s){s&&j(c),a.block.d(s),a.token=null,a=null}}}let me=null;function Fe(t,c,l){let a,s;ue(t,Ae,n=>l(24,a=n)),ue(t,Oe,n=>l(25,s=n));let o,V=new we,e=new ve(V);async function G(){return o=await e.backend({id:"defaults_q_backend",type:"query",query:"SELECT gid, fusion_early_first, fusion_early_last, fusion_late_first, fusion_late_last, evi_month FROM admin_raw ORDER BY gid",name:"defaults_q",defaults:s,backend:a}).execute(),o}const b=G();let w=Ce;const N=new w("https://rightful-anteater-150.convex.cloud");N.mutation("saveParams"),N.query("getParams");let u=null,v=null,g=null,M=null,m=null,P=null,p=null,_=null,F=null,f=null;$e(async()=>{await G(),e.view([M,u,p,m,v,g,me,_,P,F,f]);const n=e.backend({id:"village_q_backend",type:"query",query:"SELECT gid, village FROM admin_raw ORDER BY gid",name:"villages",defaults:s,backend:a});e.render(n,u);const z=e.backend({id:"climatology_q_backend",type:"query",query:K.climatology.query,name:"climatology",defaults:s,backend:a});e.render(z,_);const J=e.backend({id:"crop_cal_q_backend",type:"query",query:K.crop_cal.query,name:"crops",defaults:s,backend:a});e.render(J,M);const r=e.backend({id:"payout_q_backend",type:"query",query:K.payout_combined.query,name:"payouts",defaults:s,backend:a}),k=e.backend({id:"badyear_q_bbackend",type:"query",query:K.badyear.query,name:"badyear",defaults:s,backend:a});e.render([r,k],m),e.render(r,f);const S=e.backend({id:"matching_q_backend",type:"query",query:K.matching.query,defaults:s,backend:a}),h=e.backend({id:"matching_table_backend",type:"matching",matching:qe,ignore_cols:["year","gid","value"],default_func:"true positive",backend:S}),C=e.backend({id:"dropdown_matching_q_backend",type:"query",query:"SELECT * FROM (VALUES (0,'true positive'),(1,'true negative'),(2,'average matching')) MATCHING_OPTIONS(idx, value); ",name:"dropdown matching",defaults:null,backend:a});e.render(C,p),e.render(h,P);const X=e.backend({id:"overlays",type:"overlay"});e.render(X,[_,M]),e.connect(X,v.drag,{sum_early:{left:d=>d.left,right:d=>d.right}}),e.connect(X,g.drag,{sum_late:{left:d=>d.left,right:d=>d.right}}),[J,z,r,k,h].forEach(d=>{e.connect(d,v.drag,{sum_early_first:i=>i.left,sum_early_last:i=>i.right}),e.connect(d,g.drag,{sum_late_first:i=>i.left,sum_late_last:i=>i.right}),e.connect(d,u.change,{region:i=>i.gid})}),e.connect(h,p.change,{func_elected:d=>d.value}),e.render(m.brushX,m),e.render(_.brushX,_),e.render(f.valid,null);const I=(d,i,Y)=>o.filter(oe=>oe[i]===d[0].store.val()[i])[0][Y];e.dependencies.add(u.change.get("gid"),v,null,(d,i)=>({left:I(i,"gid","fusion_early_first"),right:I(i,"gid","fusion_early_last")})),e.dependencies.add(u.change.get("gid"),g,null,(d,i)=>({left:I(i,"gid","fusion_late_first"),right:I(i,"gid","fusion_late_last")})),e.dependencies.add(u.change.get("gid"),me,null,(d,i)=>{const Y={Sep:{start:24,end:27},Oct:{start:27,end:30},Nov:{start:30,end:33}};return{left:Y[I(i,"gid","evi_month")].start,right:Y[I(i,"gid","evi_month")].end}}),[n,z,J,r,k,h,C].forEach(async d=>{await d.execute()}),X.execute([{sum_early:{left:18,right:21},sum_late:{left:25,right:27}}])});function U(n){L[n?"unshift":"push"](()=>{F=n,l(8,F)})}function q(n){L[n?"unshift":"push"](()=>{u=n,l(0,u)})}function H(n){L[n?"unshift":"push"](()=>{f=n,l(9,f)})}function ne(n){L[n?"unshift":"push"](()=>{_=n,l(7,_)})}function te(n){L[n?"unshift":"push"](()=>{M=n,l(3,M)})}function ae(n){L[n?"unshift":"push"](()=>{v=n,l(1,v)})}function re(n){L[n?"unshift":"push"](()=>{g=n,l(2,g)})}function le(n){L[n?"unshift":"push"](()=>{m=n,l(4,m)})}function se(n){L[n?"unshift":"push"](()=>{p=n,l(6,p)})}function ie(n){L[n?"unshift":"push"](()=>{P=n,l(5,P)})}return[u,v,g,M,m,P,p,_,F,f,e,b,N,U,q,H,ne,te,ae,re,le,se,ie]}class Ye extends fe{constructor(c){super(),he(this,c,Fe,xe,be,{},null,[-1,-1])}}export{Ye as default};
